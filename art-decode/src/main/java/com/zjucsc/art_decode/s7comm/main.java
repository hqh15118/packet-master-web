package com.zjucsc.art_decode.s7comm;

import com.zjucsc.art_decode.ArtDecodeCommon;
import com.zjucsc.art_decode.artconfig.S7Config;
import com.zjucsc.art_decode.base.ValidPacketCallback;
import com.zjucsc.common.common_util.ByteUtil;
import com.zjucsc.tshark.packets.FvDimensionLayer;

import java.util.HashMap;
import java.util.Map;

public class main {
    private static S7Decode s7Decode =new S7Decode();

    private static Map<String,Float> tech_map = new HashMap<>();

    private static S7Config s7Config = new S7Config()
    {
        {
            setTag("test");
            setLength(4);
            setType("float");
            setDatabase(80);
            setByteoffset(678);
        }
    };

    private static byte[] load1 = ByteUtil.hexStringToByteArray("08000601004008000601000300a7fefe030007f00004800000893207004b4e00000800890001120411420701ff09008500010101127fb019010008000a12005000200300500137020050015e08005002580e005002801e005002a61300500320060050035c010050039a200050044c020050046c20005004b01f005004d0200050051402005005341f0050057804005005990d005005dc20005006a420005006c41d005006e42000500707080050072708005008340001010ffc7188beb2eb3b20fc7188beb2eb3c00000000d5");
    private static byte[] load2 = ByteUtil.hexStringToByteArray("08000601000308000601004001eafefe030007f0667b800000823207006d4e00000c01c8000112081282070100000000ff0901c40001ff0901be0aff000000000000000000000000000000000000ff3b3b3bff0f0fff45e3600045b90000ff4160000040392f6f000000000000ff412dca5d44167b8e000000000000000000000000000045e3600045b90000ff52300000000004008444844400000000000000ff000000000000ff00ff0e09050505050509090503030904040404050508080505050503030202080000ff0000ff1e04050002020309021008020011111111110202020202020305050500040404ff04040400040404050505000202020202020202020808080404080504040000ff0c02020202020208080808040408090809000002020808050504040908020204ff0404ff0e000202020202020008080808080809080908020204040808040804040808ff05040403ff08040408080408080009080808ff3202020202030203020202020202020211020220212020020302020202020203ff0202020202020202020202020202020202020202020202020202020202020202ff0202020202020202020202020202020202020202020202020202020202ff0000000000000000000000000000000000000000000000000000000000000000ff0000000000000000ff0e0905050505050900010907fc7188beb31f8300fc7188beb31f851000000217");

    private static FvDimensionLayer layer = new FvDimensionLayer();

    public static void main(String[] args) {
        ArtDecodeCommon.registerPacketValidCallback(new ValidPacketCallback() {
            @Override
            public void callback(String argName, float value, FvDimensionLayer layer, Object... objs) {
            }
        });
        s7Decode.decode(s7Config,tech_map,load1,layer,0);
        s7Decode.decode(s7Config,tech_map,load2,layer,0);
        System.out.println(s7Decode.map);
        System.out.println(tech_map);

    }

}
