create table user(
  name CHAR(255) PRIMARY KEY NOT NULL ,
  password VARCHAR(64) NOT NULL ,
  role VARCHAR(32) NOT NULL,
  last_login_time VARCHAR(255) NOT NULL,
  token VARCHAR(255)
)ENGINE = INNODB;

create table operation_filter(
  device_id INT PRIMARY KEY NOT NULL ,
  user_name VARCHAR(64) NOT NULL ,
  content TEXT
)engine = INNODB;

create table five_dimension_filter(
  device_id INT PRIMARY KEY NOT NULL ,
  user_name VARCHAR(64) NOT NULL ,
  content TEXT NOT NULL
)ENGINE = INNODB;

create table gplot(
  id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
  name VARCHAR(64) NOT NULL ,
  info TEXT NOT NULL
)ENGINE = INNODB;

create table device_info(
  id INT PRIMARY KEY NOT NULL ,
device_type INT NOT NULL ,
device_ip VARCHAR(64) NOT NULL ,
device_info VARCHAR(255) NOT NULL
)ENGINE = INNODB;

create table operation_filter(
  device_id INT PRIMARY KEY NOT NULL ,
  protocol VARCHAR(64) NOT NULL ,
  content TEXT  NOT NULL ,
  user_name VARCHAR(64) NOT NULL
)ENGINE  = INNODB;


create table fv_dimension_filter(
  id INT PRIMARY KEY AUTO_INCREMENT,
  device_id INT  NOT NULL ,
  user_name VARCHAR(64)  ,
  filter_type INT(1) ,
  src_ip VARCHAR(64) ,
  dst_ip VARCHAR(64) ,
  src_mac VARCHAR(64) ,
  dst_mac VARCHAR(64) ,
  src_port VARCHAR(64) ,
  dst_port VARCHAR(64) ,
  protocol VARCHAR(64)
)ENGINE = INNODB;


create table opt_filter (
  id INT PRIMARY KEY AUTO_INCREMENT,
  device_id INT  NOT NULL ,
  user_name VARCHAR(64),
  filter_type INT(1) NOT NULL ,
  fun_code INT(4) NOT NULL ,
  protocol_id INT(2) NOT NULL
)ENGINE  = INNODB;


DELETE FROM five_dimension_filter where 1=1;

DELETE FROM user where 1=1;

create table attack_info(
  id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
  time VARCHAR(64) NOT NULL ,
  device_type INT(2) NOT NULL ,
  device_ip VARCHAR(64) NOT NULL ,
  src_ip VARCHAR(64) ,
  dst_ip VARCHAR(64) ,
  src_mac VARCHAR(64) ,
  dst_mac VARCHAR(64) ,
  src_port VARCHAR(64),
  dst_port VARCHAR(64),
  protocol VARCHAR(64),
  attack_info TEXT
)ENGINE = INNODB;

create table configuration(
  id INT PRIMARY KEY  AUTO_INCREMENT,
  protocol_id INT(4) ,
  fun_code INT(4) ,
  opt VARCHAR(64)
)ENGINE  = INNODB;

DELETE FROM configuration where 1 = 1;